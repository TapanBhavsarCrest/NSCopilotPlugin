Descriptor:
    Name: Compromised Creds Agent
    DisplayName: Entra and Netskope compromised credential Agent
    Description: Extreact the compromised credential alert for a given user at Netskope and Entra and find the correlation.

SkillGroups:
    - Format: Agent
      Skills:
        - Name: CompromisedCredsAgent
          DisplayName: Entra and Netskope compromised credential Agent
          Description: Extreact the compromised credential alert for a given user at Netskope and Entra and find the correlation.
          Inputs:
            - Name: text
              Description: User query/prompt. This query will contain the file object details and duration for which you want to fetch the details from Netksope and Entra
          Settings:
            Instructions: |-
                Use mentioned two skills to generate the correlation output.
                - Do not procede if query string is empty.
                - Extract the user email from user query/text.
                - use the skill `AskUploadedFiles` to fetch the Failure/Interrupted login Entra logs for that user email as UPN list using `EntraSignOnLogs.txt`.
                - Use skill `AlertLookupAgent` to gather all netskope alerts for compromised credential as per user query.
                - Provide the correlation analysis between output of GetEntraSignInLogsV1 and AlertLookupAgent.

                User Query:
                {{text}}
          ChildSkills:
          - "AlertLookupAgent"
          - "AskUploadedFiles"
