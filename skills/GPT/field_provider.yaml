Descriptor:
    Name: Netskope field provider
    DisplayName: Netskope field provider
    Description: provides fields for the event type to create further JQL query.

SkillGroups:
    - Format: GPT
      Skills:
        - Name: GetFields
          DisplayName: Netskope JQL guidelines
          Description: This agent will gathers JQL input elements from user intent..
          Inputs:
            - Name: user_query
              Description: User query/prompt. This query will contain the user intent.
          Settings:
            ModelName: gpt-4.1
            Template: |-
              ## user query:
              {{user_query}}

              ## field provider Guidelines:
              - get 'event type' based on user query intent.
              - event type must from the following names:
                  - alert_event
                  - application_event
                  - page_event
                  - client_event
                  - incident_event
                  - network_event
              - provide the only field names for the following event type.
                  - event_type: alert_event
                    field_names: ns_tenant_id,ns_id,user,ns_retention,timestamp,ns_creation_timestamp,ns_insertion_epoch_timestamp,acked,alert_name,alert_type,appcategory,count,type,alert,organization_unit,groups_source,evt_groups,userkey,ns_userkey_enc,ur_normalized,os,os_family,instance_tags,connection_type,driver,port,device,browser,access_method,traffic_type,site,app,ns_session_begin,activity,object_type,srcip,object,src_location,src_region,src_country,src_zipcode,ns_category_id,policy,qdomain,qtype,instance_id,userip,ns_userip_enc,event_type,risk_level,action,url,dst_location,dst_country,dst_region,dstip,dst_zipcode,app_session_id,profile_id,ns_mladc,risk_level_id,orig_ty,from_user,breach_date,breach_id,breach_media_references,breach_score,breach_target_references,email_source,matched_username,md5,external_email,threshold,hostname,object_id,file_type,file_size,connection_id,src_geoip_src,severity,dst_timezone,bin_timestamp,threshold_time,dst_geoip_src,mime_type,os_version,managed_app,transaction_id,page,ns_page_enc,browser_session_id,referer,ns_referer_enc,telemetry_app,browser_version,page_site,useragent,device_classification,suppression_key,ns_resource_name,dlp_file,file_lang,dlp_profile,dlp_rule,dlp_incident_id,dlp_parent_id,dlp_rule_severity,dlp_rule_count,user_id,ns_mlada,ns_mlade,ns_mladf,ns_mladl,ns_mladm,ns_mladn,ns_mladp,ns_mlads,ns_mladt,ns_mladv,ns_mladw,evid,reladb,instance,ns_last_long_lat,last_app,last_country,last_device,last_location,last_region,last_timestamp,scan_type,modified,owner,req_cnt,resp_cnt,conn_duration,client_bytes,numbytes,server_bytes,exposure,shared_with,srcip2,file_path,dlp_is_unique_count,parent_id,suppression_end_time,suppression_start_time,user_generated,notify_template,to_object,total_collaborator_count,app_activity,ns_hostname,ns_hostpop,to_user,internal_collaborator_count,request_id,file_password_protected,universal_connector,download_app,conn_endtime,conn_starttime,ns_appsession_start,external_collaborator_count,ns_nsp_dur_back,ns_nsp_dur_front,ns_nsp_retrans_back,ns_nsp_retrans_front,ns_nsp_rtt_back,ns_nsp_rtt_front,nsdeviceuid,domain,http_transaction_count,bypass_traffic,src_timezone,managementID,tss_mode,model_name,ns_category_tags,ns_notify,from_object,shared_credential_user,two_factor_auth,user_category,shared_domains,file_id,malware_id,malware_name,malware_type,ns_detection_name,malware_severity,ns_internal_detection_engine,detection_engine,object_count,severity_id,app_name,ns_org_hash,resp_content_len,resp_content_type,local_md5,ns_home_pop_name,local_sha256,malware_profile,org,title,data_type,created_date,web_url,ns__cookie_uid,from_user_category,dlpfv,shared_type,dlp_mail_parent_id,orignal_file_path,modified_date,justification_reason,aggregated_user,dstport,log_file_name,fromlogs,justification_type,serial,act_user,ns_skip_cache,from_storage,trust_computer_checked,ns_activity,ns_home_pop_id,threat_match_field,threat_match_value,malsite_category,user_name,zip_password,path_id,malsite_id,severity_level,severity_level_id,malsite_country,ns_md5,audit_type,region_id,malsite_ip_host,policy_id,resource_category,sa_profile_id,sa_profile_name,sa_rule_id,sa_rule_name,sa_rule_severity,malsite_latitude,malsite_longitude,account_id,audit_category,malsite_region,account_name,user_role,iaas_asset_tags,region_name,detection_type,web_universal_connector,scan_time,malicious,threat_source_id,dsthost,sfwder,to_user_category,scopes,retro_scan_name,temp_user,tss_license,filename,malsite_active,malsite_confidence,malsite_consecutive,malsite_first_seen,malsite_hostility,malsite_last_seen,malsite_reputation,tunnel_id,ns_path_id,activity_type,malsite_isp,ns_file_type,role,activity_status,ns_status_code,local_sha1,shared,User_SPACE_Name,ns_quarantine_profile_id,profile_emails,quarantine_profile_id,malsite_as_number,malsite_city,malware_retention_download,malware_child_file_detection,quarantine_file_id,User_SPACE_Id,ns_policy_category_id,ns_file_lang,ns_file_size,app_category,logintype,q_admin,q_original_filename,quarantine_profile,to_storage,loginurl,q_app,q_instance,quarantine_file_name,q_original_shared,q_original_filepath,q_original_version,fastscan_results,ns_globalbl_threat_intel,Url2Activity,sessionid,scanner_result,ns_browser_notification,gateway,dlp_fingerprint_classification,dlp_fingerprint_score,malsite_dns_server,dlp_fingerprint_match,appname,malware,user_key,links,public,var_from_user,TSS_version,filePath,fileSize,fileType,modifiedDate,pathId,sharedType,app_region,parentId,detected_file_type,id,session_id,ns_current_object,ns_current_file_size,upload_tmp,domain_shared_with,app_action_cnt,latency_max,latency_min,latency_total,ns_policy_data,ns_policy_name,bucket,region,sender,srcport,workspace,workspace_id,network,dlp_rule_score,driveId,graphId,itemId,listId,remediation_profile,q_shared_with,channel,ns_notification_type,tmp_obj,ns_add_http_trailer,ns_compute_ciphertext_digest,team,quarantine_app,quarantine_encrypt,ns_policy_hash,ns_lh_profile_id,legal_hold_profile_name,lh_custodian_email,lh_custodian_name,lh_dest_app,lh_dest_instance,lh_fileid,lh_filename,lh_original_filename,lh_version,lh_shared,lh_filepath,ns_sha512,temp5,data_center,ns_dlp_match,ns_dlp_severity,instance_type,enterprise,enterprise_id,action_method,tmp_object_id,ns_good_versions,http_status,app_scopes,encrypt_failure,sub_type,violating_user,violating_user_type,attached_to,from_tmp_user,quarantine_action_reason,repo,redirect_url,lh_shared_with,dlp_unique_count,user_tmp,event_detail,collaborated,oauth,field_name,new_value,old_value,actions_taken,edr_app,endpoint_count,endpoints,tss_profile,quarantine_failure,obfuscate,ns_srcip_enc,attachment,ns_user_enc,bitD_detection_name,malware_detection_engine,to_object_id,custom_connector,report_id,ssl_decrypt_policy,dynamic_classification,ns_url_enc,alert_id,ns_src_ip_ver,ns_ver,gid,signature,signature_id,device_version,message,anomaly_efficacy,anomaly_fields,last_modified_timestamp,ipblock,dlp_fail_reason,dlp_scan_failed,osversionhostname,anomaly_type,md5_list,policy_actions,t_start,statistics,summary,raw_event,raw_event_enc,dst_latitude,dst_longitude,src_latitude,src_longitude,ns_custom_attr_nested.key,ns_custom_attr_nested.value,data_processing_ts,version,ns_meta,appsuite,rbi_action,data_classification_label,previous_data_classification_label,ip_protocol,netskope_pop,cve_id,saml_groups,domain_ip,service
                  - event_type: application_event
                    field_names: ns_tenant_id,ns_id,user,ns_retention,timestamp,ns_creation_timestamp,ns_insertion_epoch_timestamp,appcategory,count,type,site,app,traffic_type,ur_normalized,os,instance_tags,device,alert,organization_unit,groups_source,evt_groups,browser,activity,object_type,access_method,object,ns_session_begin,srcip,src_location,userkey,ns_userkey_enc,src_country,src_region,src_zipcode,ns_category_id,userip,ns_userip_enc,instance_id,from_user,object_id,app_session_id,url,dst_country,dst_location,dst_region,dst_zipcode,dstip,file_type,src_geoip_src,md5,policy,file_size,action,connection_id,dst_timezone,severity,managed_app,os_version,transaction_id,dst_geoip_src,to_object,referer,ns_referer_enc,telemetry_app,ns_resource_name,browser_version,page,ns_page_enc,page_site,browser_session_id,to_user,device_classification,hostname,from_object,suppression_key,alert_type,user_id,universal_connector,suppression_end_time,suppression_start_time,dlp_file,file_lang,dlp_profile,dlp_rule,dlp_incident_id,incident_id,os_family,dlp_parent_id,parent_id,dlp_rule_severity,dlp_rule_count,object_count,mime_type,from_storage,two_factor_auth,scan_type,modified,instance,owner,data_type,shared_with,app_activity,exposure,file_path,ns_nsp_dur_back,ns_nsp_dur_front,ns_nsp_retrans_back,ns_nsp_retrans_front,ns_nsp_rtt_back,ns_nsp_rtt_front,dlp_is_unique_count,src_timezone,user_category,nsdeviceuid,total_collaborator_count,notify_template,activity_type,internal_collaborator_count,file_password_protected,temp_user,ns_category_tags,managementID,justification_reason,justification_type,tss_mode,request_id,trust_computer_checked,external_collaborator_count,alert_name,activity_status,ns__cookie_uid,ns_notify,shared_domains,ns_hostname,ns_hostpop,ns_appsession_start,from_user_category,audit_category,audit_type,var_from_user,file_id,event_type,malware_id,malware_name,malware_type,malware_severity,ns_detection_name,ns_internal_detection_engine,detection_engine,app_name,ns_org_hash,severity_id,user_name,web_universal_connector,local_md5,ns_home_pop_name,act_user,local_sha256,to_user_category,title,ns_activity,web_url,created_date,malware_profile,user_role,dlp_mail_parent_id,org,dlpfv,shared_type,orignal_file_path,modified_date,ns_skip_cache,ns_home_pop_id,oauth,redirect_url,path_id,risk_level,zip_password,instance_type,dstport,data_center,aggregated_user,log_file_name,req_cnt,resp_cnt,conn_duration,fromlogs,ns_md5,serial,scopes,account_id,policy_id,region_id,resource_category,sa_profile_id,sa_profile_name,sa_rule_id,sa_rule_name,sa_rule_severity,sender,account_name,tmp_object_id,iaas_asset_tags,region_name,role,client_bytes,numbytes,server_bytes,to_storage,temp5,upload_tmp,detection_type,tmp_obj,dsthost,app_region,scan_time,sfwder,retro_scan_name,tss_license,event_detail,tunnel_id,filename,from_tmp_user,Url2Activity,User_SPACE_Id,User_SPACE_Name,app_category,logintype,loginurl,ns_path_id,useragent,user_tmp,ns_file_type,local_sha1,quarantine_profile_id,ns_quarantine_profile_id,profile_emails,quarantine_file_id,shared,ns_file_lang,ns_file_size,q_admin,q_original_filename,quarantine_profile,q_app,q_instance,quarantine_file_name,fastscan_results,malicious,threat_match_field,threat_source_id,threat_match_value,malsite_category,q_original_shared,q_original_filepath,q_original_version,sessionid,ns_browser_notification,srcport,session_id,dlp_fingerprint_classification,dlp_fingerprint_score,dlp_fingerprint_match,gateway,id,bucket,region,workspace,workspace_id,ns_status_code,ns_add_http_trailer,ns_compute_ciphertext_digest,ns_current_file_size,ns_current_object,ns_sha512,ns_globalbl_threat_intel,tag,field_name,new_value,old_value,ns_policy_data,ns_policy_name,to_object_id,dlp_rule_score,enterprise,enterprise_id,repo,channel,quarantine_app,quarantine_encrypt,network,appname,links,malware,public,user_key,ns_policy_hash,ns_dlp_match,ns_dlp_severity,ns_notification_type,ns_lh_profile_id,legal_hold_profile_name,lh_custodian_email,lh_custodian_name,lh_dest_app,lh_dest_instance,lh_fileid,lh_filename,lh_original_filename,lh_version,lh_shared,lh_filepath,team,q_shared_with,app_scopes,remediation_profile,action_method,attachment,ns_good_versions,parentId,encrypt_failure,sub_type,violating_user,violating_user_type,attached_to,lh_shared_with,str_tmp_3,http_status,scanner_result,domain_shared_with,desired_action,dlp_unique_count,collaborated,driveId,graphId,itemId,listId,actions_taken,edr_app,endpoint_count,endpoints,tss_profile,userjustify,quarantine_failure,ns_srcip_enc,obfuscate,ns_user_enc,custom_connector,bitD_detection_name,malware_detection_engine,message,device_version,ns_url_enc,report_id,ns_src_ip_ver,ns_ver,gid,profile_id,signature,signature_id,raw_event,raw_event_enc,dst_latitude,dst_longitude,src_latitude,src_longitude,ns_custom_attr_nested.key,ns_custom_attr_nested.value,data_processing_ts,version,ns_meta,appsuite,qos_link_name,qos_class_name,dlp_fail_reason,dlp_scan_failed,rbi_action,data_classification_label,previous_data_classification_label,netskope_pop,saml_groups
                  - event_type: page_event
                    field_names: ns_tenant_id,ns_id,user,ns_retention,timestamp,ns_creation_timestamp,ns_insertion_epoch_timestamp,appcategory,other_categories,count,os,os_family,instance_tags,browser,device,type,ur_normalized,traffic_type,srcip,organization_unit,groups_source,evt_groups,user_generated,site,client_bytes,numbytes,req_cnt,resp_cnt,server_bytes,app_session_id,conn_duration,app,src_location,src_country,src_region,dst_country,dst_location,dst_region,dstip,dst_zipcode,src_zipcode,url,access_method,userkey,ns_userkey_enc,useragent,connection_id,userip,ns_userip_enc,severity,conn_endtime,conn_starttime,ns_category_id,domain,page,ns_page_enc,bypass_traffic,os_version,browser_version,browser_session_id,http_transaction_count,dst_timezone,hostname,resp_content_len,resp_content_type,src_geoip_src,dst_geoip_src,suppression_end_time,suppression_start_time,src_timezone,ns_session_begin,transaction_id,org,policy,aggregated_user,log_file_name,dstport,fromlogs,serial,alert,ns_hostname,ns_hostpop,malicious,dsthost,ssl_decrypt_policy,ns_mladc,acked,alert_name,alert_type,event_type,profile_id,risk_level,risk_level_id,threshold,sfwder,tunnel_id,ns_last_long_lat,last_app,last_country,last_device,last_location,last_region,last_timestamp,action,sessionid,file_type,gateway,referer,ns_referer_enc,app_action_cnt,id,latency_max,latency_min,latency_total,network,http_status,ns_srcip_enc,obfuscate,ns_user_enc,ns_url_enc,logtype,raw_event,raw_event_enc,src_longitude,src_latitude,dst_longitude,dst_latitude,ns_custom_attr_nested.key,ns_custom_attr_nested.value,data_processing_ts,rbi_template_name,version,ns_meta,qos_link_name,qos_class_name,rbi_action,netskope_pop,saml_groups
                  - event_type: client_event
                    field_names: ns_tenant_id,ns_id,device_id,client_version,device_make,device_model,hostname,last_hostinfo_update_timestamp,nsdeviceuid,serial_number,management_id,steering_config,last_connected_from_private_ip,mac_addresses,os,os_version,device_classification_status,device_classification_custom_status,userkey,username,deleted,lse_status,lse_status_v2,lse_service_name,lse_npa_status,lse_event,lse_event_details,lse_actor,timestamp,onprem_status,onprem_method,onprem_domain,onprem_config_ip,onprem_match_ip,ns_insertion_epoch_timestamp,raw_event,raw_event_enc,version,ns_meta
                  - event_type: incident_event
                    field_names: ns_tenant_id,ns_id,timestamp,ns_insertion_epoch_timestamp,object_id,file_type,file_size,file_lang,ns_client_file_type,mime_type,os,app_activity,shared_with,ns_session_begin,url,request_id,instance_id,instance,file_title,file_path,suppression_key,type,sub_type,violating_user,browser,app,access_method,modified,from_user,object,object_type,collaborated,activity,dstip,alert,user,ur_normalized,owner,md5,device,user_id,is_inline_dlp,dlp_incident_id,dlp_parent_id,dlp_incident_severity,severity,exposure,dlp_forensic_id,dlp_action,dlp_policy,dlp_policy_hash,dlp_scan_type,dlp_incident_rule_count,dlp_rule_score,dlp_rule_name,dlp_rule_severity,dlp_rule_is_unique_count,dlp_rule_weighted,dlp_profile_name,dlp_fingerprint_classification,dlp_fingerprint_match,dlp_fingerprint_score,dlp_save_original_input,ns_activity,count,organization_unit,dst_location,dst_region,dst_zipcode,dst_country,dst_timezone,dst_latitude,dst_longitude,sha256,forensic_enabled,destination_app,destination_instance_id,forensic_profile_id,zip_file_id,acting_user,assignee,status,srcip,src_location,src_region,src_zipcode,src_country,src_latitude,src_longitude,site,to_user,smtp_to,title,cc,bcc,subject,message_id,smtp_status,true_obj_category,true_obj_type,orignal_file_path,original_file_id,metadata_file_id,original_file_status,original_file_snapshot_id,transaction_id,hostname,connection_id,app_session_id,network,userip,usb_device,endpoint_application,ep_policy,ep_rule_type,ep_rule_app,ep_rule_inst,ep_rule_name,ep_rule_origin,ep_action,ep_desired_action,raw_event,raw_event_enc,version,ns_meta,ua_instance,data_classification_label,previous_data_classification_label
                  - event_type: network_event
                    field_names: ns_tenant_id,ns_id,ns_retention,timestamp,ns_creation_timestamp,ns_insertion_epoch_timestamp,ns_ef_received_at,type,traffic_type,alert,alert_type,action,srcip,ns_srcip_enc,srcport,dstip,dstport,network_session_id,ip_protocol,protocol,site,app,appcategory,browser,browser_version,device,domain,policy,qdomain,qtype,severity,userkey,ns_userkey_enc,user,ns_user_enc,ur_normalized,userip,ns_userip_enc,organization_unit,client_bytes,server_bytes,numbytes,count,client_packets,server_packets,total_packets,start_time,end_time,session_duration,tunnel_type,tunnel_id,tunnel_up_time,access_method,netskope_pop,ns_hostname,ns_category_id,num_sessions,publisher_cn,dsthost,hostname,transaction_id,os,os_version,group,dst_geoip_src,dst_latitude,dst_longitude,dst_country,dst_zipcode,dst_location,dst_region,dst_timezone,src_geoip_src,src_latitude,src_longitude,src_country,src_zipcode,src_location,src_region,src_timezone,src_time,raw_event,raw_event_enc,ns_custom_attr_nested.key,ns_custom_attr_nested.value,data_processing_ts,version,ns_meta,protocol_port,private_app_tags,publisher_tags,qos_link_name,qos_class_name,dns_response_time,domain_ip,service,smtp_client_domain,smtp_block_reason,publisher_ip,publisher_pop,publisher_port,ns_nsp_dur_back,ns_nsp_dur_front,ns_nsp_retrans_back,ns_nsp_retrans_front,ns_nsp_rtt_back,ns_nsp_rtt_front
